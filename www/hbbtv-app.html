<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>HbbTV App</title>
</head>
<body>
Open log console to see debug output
<script type="text/javascript">
    var app2appLocalBaseUrl = "ws://localhost:8080/local/" ;
    var appEndpoint = "org.mychannel.myapp";
    var createConnection = function (index) {
        var ws = new WebSocket(app2appLocalBaseUrl + appEndpoint);
        ws.onopen = function(evt) {
            console.log("Connection ",index," waiting ...");
        };
        ws.onclose = function(evt) {
            console.log("Connection ",index," closed.");
        };
        ws.onerror = function (evt) {
            console.log("Connection error.");
        };
        ws.onmessage = function(evt) {
            if (evt.data == "pairingcomplete") {
                console.log("connection ",index," paired");
                ws.onmessage = function(evt) {
                    console.log( "Received Message: " + evt.data);
                };
                ws.send("Hello from HbbTV App: "+index);
                createConnection(index+1);
            } else {
                console.log("Unexpected message received from terminal.");
                ws.close();
            }
        };
    };
    createConnection(0);
</script>
</body>
</html>